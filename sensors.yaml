# --- Template ---
  - platform: template
    sensors:
      date_template:
        friendly_name: 'Datum'
        value_template: '{{ as_timestamp(now()) | timestamp_custom("%d.%m.%Y", True) }}'
        entity_id: sensor.date
      luftfeuchtigkeit_kuche_aqara:
        friendly_name: 'Luftfeuchtigkeit Küche'
        unit_of_measurement: '%'
        value_template: "{{ (states('sensor.lumi_lumi_weather_57dc3d03_humidity') | float) | round }}"
        device_class: humidity
      temp_kuche_aqara:
        friendly_name: 'Temp. Küche Aqara'
        unit_of_measurement: '°C'
        value_template: "{{ (states('sensor.lumi_lumi_weather_57dc3d03_temperature') | float) | round(1) }}"
        device_class: temperature
      luftdruck_kuche_aqara:
        friendly_name: 'Luftdruck Küche Aqara'
        unit_of_measurement: 'hPa'
        value_template: "{{ (states('sensor.lumi_lumi_weather_57dc3d03_pressure') | float) | round }}"
        device_class: pressure

      # --- Elektrische Leistung ---
      # Backofen
      el_leistung_backofen_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_backofen') | float) | float }}"
        friendly_name: 'El. Leistung Backofen (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Kühlschrank Küche
      el_leistung_kuhlschrank_kuche_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_kuhlschrank_kuche') | float) | float }}"
        friendly_name: 'El. Leistung Kühlschrank Küche (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Spülmaschine
      el_leistung_spulmaschine_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_spulmaschine') | float) | float }}"
        friendly_name: 'El. Leistung Spülmaschine (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Mixi
      el_leistung_mixi_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_mixi') | float) | float }}"
        friendly_name: 'El. Leistung Mixi (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # TV
      el_leistung_tv_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_tv') | float) | float }}"
        friendly_name: 'El. Leistung TV (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Waschmaschine
      el_leistung_waschmaschine_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_waschmaschine') | float) | float }}"
        friendly_name: 'El. Leistung Waschmaschine (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Trockner
      el_leistung_trockner_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_trockner') | float) | float }}"
        friendly_name: 'El. Leistung Trockner (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Kühlschrank Keller
      el_leistung_kuhlschrank_keller_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_kuhlschrank_keller') | float) | float }}"
        friendly_name: 'El. Leistung Kühlschrank Keller (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Gefrierschrank
      el_leistung_gefrierschrank_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_gefrierschrank') | float) | float }}"
        friendly_name: 'El. Leistung Gefrierschrank (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Lüftungsanlage
      el_leistung_luftungsanlage_round:
        value_template: "{{ '%.1f'%(states('sensor.el_leistung_luftungsanlage') | float) | float }}"
        friendly_name: 'El. Leistung Lüftungsanlage (gerundet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      # Licht
      el_leistung_berechnet_zigbee_licht_gaestezimmer:
        value_template: "{{ '%.1f'%(state_attr('light.innr_e14_ww_decke_gastezimmer_level_on_off', 'brightness') | float / 255 * 5.3)| float }}"
        friendly_name: 'El. Leistung Licht Gästezimmer (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      el_leistung_berechnet_zigbee_stehlampe_le:
        value_template: "{{ '%.1f'%(state_attr('light.innr_e14_tw_stehlampe_lea_level_light_color_on_off', 'brightness') | float / 255 * 5.8)| float }}"
        friendly_name: 'El. Leistung Stehlampe Le (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      el_leistung_berechnet_zigbee_stehlampe_la:
        value_template: "{{ '%.1f'%(state_attr('light.innr_e14_ww_stehlampe_lara_level_on_off', 'brightness') | float / 255 * 5.3)| float }}"
        friendly_name: 'El. Leistung Stehlampe La (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      el_leistung_berechnet_zigbee_kugellicht_sz:
        value_template: "{{ '%.1f'%(state_attr('light.innr_e14_tw_kugellampe_schlafzimmer_level_light_color_on_off', 'brightness') | float / 255 * 5.8)| float }}"
        friendly_name: 'El. Leistung Kugellicht SZ (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      el_leistung_berechnet_zigbee_terrasse_ecke_gr:
        value_template: "{{ '%.1f'%(state_attr('light.innr_e27_color_terrasse_ecke_gross_level_light_color_on_off', 'brightness') | float / 255 * 9.5)| float }}"
        friendly_name: 'El. Leistung Würfel Terrasse Ecke groß (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      el_leistung_berechnet_zigbee_terrasse_ecke_kl:
        value_template: "{{ '%.1f'%(state_attr('light.innr_rb_285_c_55f50405_level_light_color_on_off', 'brightness') | float / 255 * 9.5)| float }}"
        friendly_name: 'El. Leistung Würfel Terrasse Ecke klein (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
      el_leistung_berechnet_zigbee_terrasse_feuerstelle:
        value_template: "{{ '%.1f'%(state_attr('light.innr_rb_285_c_7cc30105_level_light_color_on_off', 'brightness') | float / 255 * 9.5)| float }}"
        friendly_name: 'El. Leistung Würfel Terrasse Feuerstelle (berechnet)'
        unit_of_measurement: 'W'
        icon_template: mdi:speedometer
        
        
    
# --- Sonstiges ---
# History
  - platform: history_stats
    name: Jo at work
    entity_id: binary_sensor.jo_at_work
    state: "on"
    type: time
    start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
    end: '{{ now() }}'
  - platform: history_stats
    name: Anteil La wach letzte Stunde
    entity_id: switch.la_schlaft
    state: 'off'
    type: ratio
    end: '{{ now() }}'
    duration:
      hours: 1
  - platform: history_stats
    name: Anteil Le wach letzte Stunde
    entity_id: switch.le_schlaft
    state: 'off'
    type: ratio
    end: '{{ now() }}'
    duration:
      hours: 1
  - platform: history_stats
    name: Anteil MaJo wach letzte Stunde
    entity_id: switch.majo_schlafen
    state: 'off'
    type: ratio
    end: '{{ now() }}'
    duration:
      hours: 1

# Zeit und Datum
  - platform: time_date
    display_options:
      - 'time'
      - 'date'

# System 
  - platform: systemmonitor
    resources:
      - type: processor_use
      - type: disk_use_percent
        arg: "/"
      - type: last_boot
      - type: memory_use_percent
  - platform: command_line
    name: CPU Temperatur
    command: "cat /sys/class/thermal/thermal_zone0/temp"
    unit_of_measurement: "°C"
    value_template: '{{ value | multiply(0.001) | round(1) }}'
